GFC ECOSYSTEM – AUTHORITATIVE CONTINUATION REPORT
SECTION 03 – GFC WEB STUDIO
STATUS: UNDER REVIEW
DOCUMENT TYPE: R3 ADDENDUM – SECTION C ONLY (FULL EXECUTION EXPANSION)
ECOSYSTEM VERSION: v1.0.0
SECTION REVISION: R3-C (UNDER REVIEW – ADDITIVE ONLY)
GENERATED: 2025-12-13

================================================================================
SECTION C – DEEP UNDO, HISTORY, AND DIFFERENTIAL COMPARISON
STATUS: UNDER REVIEW
================================================================================

C.1 PURPOSE
STATUS: PENDING
Provide precise, safe recovery and inspection of content changes by enabling
granular undo, comprehensive revision history, and structured diffs. Editors must
be able to understand what changed, who changed it, when it changed, and safely
restore only the affected parts without rolling back unrelated work.

All behaviors are enforced server-side. No client-only undo is considered
authoritative.

--------------------------------------------------------------------------------
C.2 SCOPE
STATUS: PENDING

C.2.1 Included
STATUS: PENDING
• Draft revision capture
• Publish snapshot capture
• Sandbox promotion snapshots
• Structured diff computation
• Block-level and section-level restore
• Validation and audit on restore

C.2.2 Excluded
STATUS: PENDING
• Authentication and identity
• Business rules from the Web App
• Public renderer implementation details

--------------------------------------------------------------------------------
C.3 REVISION STORAGE SYSTEM
STATUS: PENDING

C.3.1 Revision Entity Definition
STATUS: PENDING

C.3.1.1 Required Fields
STATUS: PENDING
Each Revision MUST persist:
• RevisionId (GUID, immutable)
• PageId (foreign key)
• RevisionSequenceNumber (monotonic per PageId)
• RevisionType (DraftSave, PublishSnapshot, SandboxPromotion, Restore)
• ParentRevisionId (nullable)
• AuthorUserId
• CreatedUtcTimestamp
• NormalizedBlockTreeSnapshot
• MediaReferenceSnapshot
• AnimationConfigurationSnapshot
• ValidationStateSnapshot

C.3.1.2 Indexing Rules
STATUS: PENDING
Indexes MUST exist on:
• PageId + RevisionSequenceNumber
• PageId + CreatedUtcTimestamp
• RevisionType

C.3.1.3 Immutability Rules
STATUS: PENDING
Once persisted, a Revision MUST be immutable. Any change requires a new Revision.

--------------------------------------------------------------------------------
C.3.2 Revision Creation Rules
STATUS: PENDING

C.3.2.1 Draft Revision on Save
STATUS: PENDING
A draft revision MUST be created when a save operation produces a material change
to:
• Block structure
• Block content
• Media references
• Animation configuration

C.3.2.2 Non-Trigger Conditions
STATUS: PENDING
Revisions MUST NOT be created for:
• Cursor movement
• UI-only state changes
• Preview rendering
• Validation checks without mutation

C.3.2.3 Failure Handling
STATUS: PENDING
If revision persistence fails:
• Save MUST be rejected
• User MUST be notified
• No partial revision may remain

--------------------------------------------------------------------------------
C.3.3 Publish Snapshot Revisions
STATUS: PENDING

C.3.3.1 Snapshot Creation
STATUS: PENDING
On successful publish, a PublishSnapshot revision MUST be created and marked
immutable.

C.3.3.2 Snapshot Contents
STATUS: PENDING
Snapshot MUST reflect the exact content rendered publicly.

--------------------------------------------------------------------------------
C.4 DIFF COMPUTATION ENGINE
STATUS: PENDING

C.4.1 Inputs
STATUS: PENDING
The diff engine MUST accept two Revision snapshots.

C.4.2 Diff Dimensions
STATUS: PENDING
Diffs MUST be computed across:
• Block additions, removals, reordering
• Text content changes
• Media additions/removals
• Animation parameter changes

C.4.3 Output Model
STATUS: PENDING
Diff results MUST be:
• Structured
• Typed
• Renderable without executing content

C.4.4 Safety Rules
STATUS: PENDING
The diff engine MUST NOT:
• Execute scripts
• Load external resources
• Mutate stored revisions

--------------------------------------------------------------------------------
C.5 RESTORE OPERATIONS
STATUS: PENDING

C.5.1 Restore Single Block
STATUS: PENDING
Editors MAY restore a single block from a prior revision.

C.5.1.1 Restore Mechanics
STATUS: PENDING
• Target block is copied into current draft
• Conflicts are detected
• New draft revision is created

C.5.1.2 Post-Restore Validation
STATUS: PENDING
• Full validation MUST run
• Restore MUST rollback on failure

C.5.2 Restore Section Group
STATUS: PENDING

C.5.2.1 Restore Mechanics
STATUS: PENDING
Entire section grouping MAY be restored following block restore rules.

C.5.3 Restore Failure Handling
STATUS: PENDING
On failure:
• Restore MUST be aborted
• Draft MUST remain unchanged
• Errors MUST be surfaced

--------------------------------------------------------------------------------
C.6 HISTORY AND UI PRESENTATION
STATUS: PENDING

C.6.1 History Timeline
STATUS: PENDING
UI MUST display:
• Revision sequence
• Author
• Timestamp
• Revision type

C.6.2 Compare View
STATUS: PENDING
UI MUST allow selection of any two revisions for comparison.

--------------------------------------------------------------------------------
C.7 AUDIT AND LOGGING
STATUS: PENDING

C.7.1 Audited Events
STATUS: PENDING
• Revision creation
• Restore operations
• Failed restore attempts

C.7.2 Required Fields
STATUS: PENDING
Audit events MUST include:
• Actor
• Timestamp
• Target page
• Revision identifiers
• Outcome

--------------------------------------------------------------------------------
C.8 FAILURE AND RECOVERY SCENARIOS
STATUS: PENDING

C.8.1 Backend Failure
STATUS: PENDING
System MUST remain in last stable state.

--------------------------------------------------------------------------------
C.9 CURSOR PROMPT BOUNDARY MAP
STATUS: PENDING

C.9.1 Prompt Groups
STATUS: PENDING
• Revision persistence
• Diff engine
• Restore operations
• History UI
• Audit hooks

Each group MUST be implemented as independent Cursor prompts.

--------------------------------------------------------------------------------
END OF SECTION C
================================================================================
