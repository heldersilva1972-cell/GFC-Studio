// [NEW]
@page "/studio"
@layout FullPageLayout
@inject IJSRuntime JSRuntime

<div class="studio-container">
    <div class="top-command-bar">
        <div class="left-controls">
            <span class="studio-brand">GFC Studio</span>
            <div class="page-selector">
                <button class="btn btn-dark dropdown-toggle" type="button">
                    Page: Home
                </button>
            </div>
        </div>
        <div class="center-controls">
            <div class="action-buttons">
                <button class="btn btn-primary">Save Draft</button>
                <button class="btn btn-success">Publish</button>
            </div>
        </div>
        <div class="right-controls">
            <div class="device-toggle">
                <button class="btn btn-dark @(_viewport == "desktop" ? "active" : "")" @onclick='() => SetViewport("desktop")'>üíª</button>
                <button class="btn btn-dark @(_viewport == "tablet" ? "active" : "")" @onclick='() => SetViewport("tablet")'>üñ•Ô∏è</button>
                <button class="btn btn-dark @(_viewport == "mobile" ? "active" : "")" @onclick='() => SetViewport("mobile")'>üì±</button>
            </div>
            <button class="btn btn-dark history-button">
                üïí
            </button>
            <button class="btn btn-outline-danger exit-button">
                Exit Studio
            </button>
        </div>
    </div>
    <div class="studio-workspace">
        <div class="left-panel @(_isLeftPanelCollapsed ? "collapsed" : "")">
            <div class="panel-content">
                <!-- Component Library Placeholder -->
                <h5>Component Library</h5>
                <p>Drag-and-drop components will appear here.</p>
            </div>
            <div class="collapse-handle" @onclick="ToggleLeftPanel">
                @(_isLeftPanelCollapsed ? "‚ñ∂" : "‚óÄ")
            </div>
        </div>
        <div class="center-canvas">
            <div class="device-frame viewport-@(_viewport)">
                <iframe src="@($"http://localhost:3000/preview/{_pageId}")" frameborder="0"></iframe>
            </div>
        </div>
        <div class="right-panel @(_isRightPanelCollapsed ? "collapsed" : "")">
             <div class="collapse-handle" @onclick="ToggleRightPanel">
                @(_isRightPanelCollapsed ? "‚óÄ" : "‚ñ∂")
            </div>
            <div class="panel-content">
                <!-- Properties Inspector Placeholder -->
                <h5>Properties Inspector</h5>
                <p>Context-sensitive properties will appear here.</p>
            </div>
        </div>
    </div>
</div>

@code {
    private bool _isLeftPanelCollapsed = false;
    private bool _isRightPanelCollapsed = false;
    private string _viewport = "desktop";
    private int _pageId = 1; // Placeholder

    private void ToggleLeftPanel()
    {
        _isLeftPanelCollapsed = !_isLeftPanelCollapsed;
    }

    private void ToggleRightPanel()
    {
        _isRightPanelCollapsed = !_isRightPanelCollapsed;
    }

    private void SetViewport(string viewport)
    {
        _viewport = viewport;
    }
}
