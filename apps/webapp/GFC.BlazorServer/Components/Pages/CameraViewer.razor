<!-- [MODIFIED] -->
@page "/cameras/{CameraId:int}"
@inject IJSRuntime JS
@inject IConfiguration Configuration

<div class="camera-viewer">
    <h3>Live Camera Feed: Camera @CameraId <span class="badge gfc-new-tag">NEW</span></h3>

    <div class="video-container">
        <video id="camera-@CameraId" class="video-js" controls preload="auto" width="640" height="360">
        </video>
        <div class="stream-status">
            Connecting...
        </div>
    </div>
</div>

@code {
    [Parameter]
    public int CameraId { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var videoAgentUrl = Configuration["VideoAgent:BaseUrl"];
            var streamUrl = $"{videoAgentUrl}/stream/camera{CameraId}.m3u8";
            await JS.InvokeVoidAsync("CameraPlayer.init", $"camera-{CameraId}", streamUrl);
        }
    }
}
