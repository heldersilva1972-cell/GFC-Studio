// [NEW]
@using GFC.Core.Models

<div class="version-history-sidebar">
    <h5>Version History</h5>
    <div class="input-group mb-3">
        <input type="text" class="form-control" placeholder="Name this version..." @bind="versionName" />
        <button class="btn btn-outline-secondary" type="button" @onclick="NameVersion">Save</button>
    </div>
    <div class="list-group">
        @foreach (var version in Versions)
        {
            <div class="list-group-item">
                <strong>@(version.Name ?? $"Version {version.Version}")</strong>
                <small class="d-block text-muted">@version.CreatedAt.ToLocalTime().ToString("g") by @version.CreatedBy</small>
                <div>
                    <button class="btn btn-sm btn-info" @onclick="() => OnPreview.InvokeAsync(version)">Preview</button>
                    <button class="btn btn-sm btn-primary" @onclick="() => OnRestore.InvokeAsync(version)">Restore</button>
                </div>
            </div>
        }
    </div>
</div>

@code {
    [Parameter]
    public List<StudioDraft> Versions { get; set; } = new();

    [Parameter]
    public EventCallback<StudioDraft> OnPreview { get; set; }

    [Parameter]
    public EventCallback<StudioDraft> OnRestore { get; set; }

    [Parameter]
    public EventCallback<string> OnNameVersion { get; set; }

    private string versionName = "";

    private async Task NameVersion()
    {
        await OnNameVersion.InvokeAsync(versionName);
        versionName = "";
    }
}
